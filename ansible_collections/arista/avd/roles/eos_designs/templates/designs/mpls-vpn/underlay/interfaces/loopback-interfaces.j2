loopback_interfaces:
{% if switch.router_id is arista.avd.defined %}
{# BGP Loopback #}
  Loopback0:
    description: Overlay_Peering
    shutdown: false
    ip_address: {{ switch.router_id }}/32
{%     if switch.underlay_routing_protocol == "ospf" %}
    ospf_area: {{ underlay_ospf_area }}
{%     endif %}
{%     if switch.underlay_routing_protocol == "isis" %}
    isis_enable: MPLS_UNDERLAY
    isis_passive: true
{%         if label_distribution.protocol is arista.avd.defined("isis-sr") %}
{# Put node-segment stuff here #}
{%         endif %}
{%     endif %}
{% endif %}
{# Don't need vtep loopback as this is MPLS #}
{# {% if switch.vtep is arista.avd.defined(true) and switch.vtep_loopback | lower != 'loopback0' %}
{# Leaf VTEP vxlan tunnel loopback source interface #}
  {{ switch.vtep_loopback }}:
    description: VTEP_VXLAN_Tunnel_Source
    shutdown: false
    ip_address: {{ switch.vtep_ip }}/32
{%     if vtep_vvtep_ip is arista.avd.defined and switch.evpn_services_l2_only is arista.avd.defined(false) %}
    ip_address_secondaries: [{{ vtep_vvtep_ip }}]
{%     endif %}
{%     if switch.underlay_routing_protocol == "ospf" %}
    ospf_area: {{ underlay_ospf_area }}
{%     endif %}
{%     if switch.underlay_routing_protocol == "isis" %}
    isis_enable: MPLS_UNDERLAY
    isis_passive: true
{%     endif %}
{% endif %} #}
